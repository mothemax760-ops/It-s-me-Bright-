<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bright Tup Up | PUBG MOBILE</title>
<style>
  body {margin:0;font-family:'Poppins',sans-serif;background:#001a33;color:#e0f7ff;}
  header {background:rgba(5,10,20,0.95);padding:15px 25px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 0 15px #ff7b00aa;position:sticky;top:0;z-index:10;}
  header h1 {font-size:1.5rem;font-weight:700;color:#ffb347;text-shadow:0 0 15px #ff7b00,0 0 30px #ff4500;}
  .balance-box {background:rgba(255,123,0,0.2);border:1px solid #ff7b00;padding:6px 12px;border-radius:10px;font-weight:bold;color:#ffae00;margin-right:10px;}
  .container {padding:30px;}
  .section-title {font-size:1.8rem;margin:20px 0;text-align:center;text-shadow:0 0 10px #ff6f00;letter-spacing:2px;}
  .grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:25px;}
  .card {position:relative;background:linear-gradient(145deg,rgba(255,140,0,0.2),rgba(0,0,0,0.6));border:2px solid #ff6f00;border-radius:15px;padding:20px;text-align:center;box-shadow:0 0 20px #ff7b00aa;transition:0.3s;overflow:hidden;}
  .card:hover {transform:scale(1.05);box-shadow:0 0 30px #ffae00;}
  .card h3 {font-size:1.2rem;margin-bottom:10px;}
  .status {background:#00ff99;color:#000;padding:3px 10px;border-radius:10px;font-size:0.8rem;font-weight:700;}
  .tag {background:#ff7b00;color:#000;padding:3px 10px;border-radius:10px;font-size:0.8rem;font-weight:700;margin-left:5px;}
  .price {font-size:1.1rem;font-weight:bold;color:#ffb347;text-shadow:0 0 5px #ff7b00;margin-top:10px;}
  .btn-primary {background:#ff7b00;color:#000;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:bold;margin-top:15px;transition:0.3s;}
  .btn-primary:hover {background:#fff;color:#ff7b00;box-shadow:0 0 20px #ffae00;}
  .back-btn {position:fixed;top:20px;left:20px;background:rgba(255,123,0,0.2);border:1px solid #ff7b00;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;z-index:50;transition:0.3s;}
  .back-btn:hover {background:#ff7b00;color:#000;}
  .toast {position:fixed;bottom:25px;left:50%;transform:translateX(-50%);background:#ff7b00;color:#000;padding:10px 20px;border-radius:10px;font-weight:bold;opacity:0;transition:opacity 0.4s;}
  .toast.show {opacity:1;}
  /* AK47 CSS */
  .ak47 {position:relative;width:75px;height:40px;margin:auto 0 12px 0;}
  .ak47 .barrel {position:absolute;top:12px;left:0;width:60px;height:4px;background:#ff7b00;border-radius:2px;}
  .ak47 .stock {position:absolute;bottom:0;left:50px;width:18px;height:12px;background:#ff7b00;border-radius:2px;}
  .ak47 .mag {position:absolute;bottom:12px;left:20px;width:6px;height:16px;background:#ff7b00;transform:rotate(-10deg);border-radius:1px;}
  .ak47 .sight {position:absolute;top:8px;right:0;width:6px;height:4px;background:#ff7b00;border-radius:1px;}
</style>
</head>
<body>

<button class="back-btn" onclick="window.location.href='produits.html'">â¬… Retour</button>

<header>
  <h1>Bright Tup Up â€” PUBG MOBILE</h1>
  <div style="display:flex; align-items:center;">
    <div class="balance-box" id="balanceBox">0 G</div>
  </div>
</header>

<div class="container">
  <h2 class="section-title">PUBG MOBILE UC</h2>
  <div class="grid" id="productGrid"></div>
</div>

<div id="toast" class="toast">âœ… AjoutÃ© au panier</div>

<script>
/* ==========================
   ðŸ” PROFIL SÃ‰CURISÃ‰
========================== */
let user = JSON.parse(sessionStorage.getItem("dpstore_user")||"null");
if(!user || !user.email || !user.username){
  alert("âš  Vous devez Ãªtre connectÃ© !");
  window.location.href="index.html";
}

/* ==========================
   PANIER PAR UTILISATEUR
========================== */
function normalizeId(str){ return (str||"guest").toLowerCase().replace(/[^a-z0-9@.-]/g,"_").replace(/@/g,"_at_"); }
function getCartKey(){ return "cart_"+normalizeId(user.email); }
function loadCart(){ return JSON.parse(localStorage.getItem(getCartKey())||"[]"); }
function saveCart(cart){ localStorage.setItem(getCartKey(),JSON.stringify(cart)); }

function updateBalanceUI(){
  user = JSON.parse(sessionStorage.getItem("dpstore_user")||JSON.stringify(user));
  document.getElementById("balanceBox").textContent=(user.balance??0)+" G";
}

function showToast(){
  const toast=document.getElementById("toast");
  toast.classList.add("show");
  setTimeout(()=>toast.classList.remove("show"),1500);
}

/* ==========================
   PRODUITS
========================== */
const products = [
  { name:"60 UC", price:180 },
  { name:"120 UC", price:350 },
  { name:"325 UC", price:850 },
  { name:"660 UC", price:1650 },
  { name:"1800 UC", price:3500 }
];
products.forEach(p=>p.price=Math.round(p.price*1.20));

const grid=document.getElementById("productGrid");
products.forEach(p=>{
  const card=document.createElement("div");
  card.className="card";
  card.innerHTML=`
    <div class="ak47">
      <div class="barrel"></div>
      <div class="stock"></div>
      <div class="mag"></div>
      <div class="sight"></div>
    </div>
    <h3>${p.name}</h3>
    <span class="status">Disponible</span><span class="tag">PUBG</span>
    <div class="price">${p.price} HTG</div>
    <button class="btn-primary">Acheter</button>
  `;
  card.querySelector("button").addEventListener("click",()=>{
    const cart=loadCart();
    cart.push({name:p.name,price:p.price,buyer:user.email,date:new Date().toLocaleString(),status:"En attente",meta:{accountName:user.username}});
    saveCart(cart);
    showToast();
    updateBalanceUI();
  });
  grid.appendChild(card);
});

/* INIT UI */
updateBalanceUI();
setInterval(updateBalanceUI,1500);
</script>

</body>
</html>
